/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  1.0                                   |
|   \\  /    A nd           | Web:      http://www.openfoam.org               |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/

FoamFile
{
    version         2.0;
    format          ascii;
    class           dictionary;
    object          autoHexMeshDict;
}

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

castellatedMesh on;
snap            on;
addLayers       on;

geometry
{
    Toskoerper.stl       {type triSurfaceMesh; name toskoerper;}
	Wehrruecken.stl      {type triSurfaceMesh; name Wehrruecken;}
	WehrWaende.stl       {type triSurfaceMesh; name WehrWaende;}
	
    Stufe3   
	{
		type 	searchableBox;
		min 	(0 1.5 0);
		max 	(42.5 15.5 4);
	}
	
	//Stufe4
	//{
	//	type 	searchableBox;
	//	min 	(25 0 0);
	//	max 	(35 15.5 2.5);
	//}
};

castellatedMeshControls
{
    maxLocalCells 1000000;
    maxGlobalCells 2000000;
    minRefinementCells 3;
    nCellsBetweenLevels 2;
    maxLoadUnbalance 0.10;
    //features
    //(
    //    {
    //        file "europaschiff.eMesh";
    //        level 3;
    //    }
    //);

    //refinementSurfaces
    //{
    //    europaschiff
	//	{
	//		level (4 4);
	//	}   
    //    bsr_ein
	//	{
	//		level (4 4);
	//	}
	//    bsr_aus
	//	{
	//		level (4 4);
	//	}
	//	boe_backbord
	//	{
	//		level (3 3);
	//	}
	//	boe_steuerbord
	//	{
	//		level (1 1);
	//	}
	//}   
    resolveFeatureAngle 30;
    refinementRegions
    {
        Stufe3
		{
			mode 		inside;
			levels 		((1E15 2));
		}
		//Stufe4
		//{
		//	mode 		inside;
		//	levels 		((1E15 3));
		//}
    }   
	locationInMesh (2 3 3);    
    allowFreeStandingZoneFaces no;
}

snapControls
{
    nSmoothPatch 5;
    tolerance 1.0;
    nSolveIter 300;
    nRelaxIter 10;
    nFeatureSnapIter 10;
    implicitFeatureSnap true;
    explicitFeatureSnap false;
    multiRegionFeatureSnap false;
}

addLayersControls
{
    
    layers
    {
        Wehrruecken
		{
			nSurfaceLayers			10;
		}
    }  
		
	relativeSizes yes;       //false leads to absolute
    expansionRatio 1.2;
    finalLayerThickness 0.35;     //is relativeSizes are put to false, must be changed to firstLayerThickness
    minThickness 0.0002;
	nGrow 1;
    featureAngle 60;   
    slipFeatureAngle 70;
    nRelaxIter 10;
    nSmoothSurfaceNormals 3;
    nSmoothNormals 100;
    nSmoothThickness 0;
    maxFaceThicknessRatio 0.5;  // 0.5
    maxThicknessToMedialRatio 0.3; // 0.3
    minMedianAxisAngle 80; // 80
    nBufferCellsNoExtrude 1;
    nLayerIter 100;
    nRelaxedIter 50;   
    additionalReporting true;
}


meshQualityControls
{
  //include "meshQualityDict"
}


debug 0;
mergeTolerance 1.E-8;

// ************************************************************************* //